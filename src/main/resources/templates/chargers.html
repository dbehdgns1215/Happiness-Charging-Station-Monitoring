<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>충전소 지도</title>
    <script src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=tg2jn30hid"></script>
    <style>
        #map {
            width: 100%;
            height: 500px;
        }
    </style>
</head>
<body>
<h1>충전소 지도</h1>
<div id="map"></div>

<script>
    // 지도 초기화
    const map = new naver.maps.Map('map', {
        center: new naver.maps.LatLng(37.5665, 126.978), // 기본 위치 (서울)
        zoom: 10
    });

    // 충전소 데이터 가져오기
    fetch('/api/chargers') // 새로운 API 엔드포인트로 요청
        .then(response => response.json())
        .then(chargerData => {
            console.log("충전소 데이터:", chargerData);

            // 데이터가 비어있는지 확인
            if (!chargerData || chargerData.length === 0) {
                console.warn("충전소 데이터가 없습니다."); // 빈 데이터 경고
            } else {
                chargerData.forEach(charger => {
                    console.log(`충전소 추가: ${charger.name} - 위도: ${charger.latitude}, 경도: ${charger.longitude}`);

                    const marker = new naver.maps.Marker({
                        position: new naver.maps.LatLng(charger.latitude, charger.longitude),
                        map: map,
                        title: charger.name // 마커에 제목 추가
                    });

                    // 마커 클릭 시 정보 표시
                    const infowindow = new naver.maps.InfoWindow({
                        content: `<div style="width:150px;text-align:center;padding:10px;">${charger.name}</div>`
                    });

                    naver.maps.Event.addListener(marker, 'click', function() {
                        infowindow.open(map, marker.getPosition());
                    });
                });
            }
        })
        .catch(error => {
            console.error("데이터 가져오기 오류:", error);
        });
</script>

</body>
</html>
